# 姿态传感器检测跌倒
1. 阐述国内外现状，包括测量方法和测量仪器，分析各自的优缺点；
2. 提出或选择一种测量方法，设计测量仪器或系统方案（结构示意图），对传感器等主要功能部件进行详细说明；
3. 阐述测量原理（原理图），推导数学模型；
4. 分析测量仪器或系统的分辨力和测量误差，评定目标测量不确定度。
5. 每人选择1个问题，题目自拟，设计内容必须独立完成。以PPT报告和纸质设计报告（论文）形式提交，并在讨论课上“答辩”（每人15分钟以内，汇报10分钟，讨论5分钟）。
6. 每个题目最多3个人选，多人选择一个题目，方案可以相同也可以不同，但是介绍时必须分析自己与他人方案相比的优缺点。

# 背景

据统计，在美国每年在65岁以上老人中，平均每3人中就有1人发生意外跌倒，每年大约有9500位老年人死于旅行途中或跌倒；而平均年龄在65岁至69岁之间的人每200次跌倒中就有一次髋关节骨折。更严重的是，20%到30%的患者会出现中度到严重的并发症，很可能导致残疾。而在中国，老年人口已经突破2.5亿，按照30%概览推算，每年有7500万人次的老年人摔倒。请设计一种适合家用的老人跌倒检测方法，给出合理防范，并分析算法原理和数学模型。

目前主流针对跌倒检测的方法有2种：图像分析法和加速度传感器分析法。图像分析法优点在于应用广泛，设备成本低，但也有计算量较大，算力成本高等缺点。加速度传感器方法具有计算量小、不受环境限制、成本低的优点。

# mpu6050

## 简介

InvenSense公司推出的全球首款整合性6轴运动处理组件,输出三轴加速度ax,ay,az和三轴角速度gx,gy,gz,体积4x4x9mm,i2c通信,量程范围角速度±250，±500，±1000，±2000°/sec(dps),加速度±2g，±4g，±8g，±16g

## 一阶互补滤波

加速度机对加速度很敏感,用来计算倾角误差较大,陀螺仪的角速度比较准确,但积分漂移和温度漂移误差较大,两个传感器可以弥补相互缺点,单纯以六轴传感器不能得到准确的Yaw角,但在跌倒场景中,Yaw角并不是特别重要.

比如对于pitch角(绕y轴旋转角),由加速度计计算得到的绕y轴角度(x轴转过的角度)$angleAy=\frac{ax}{\sqrt{ay^2+az^2}}$,由陀螺仪计算得到的绕y轴角度$angleGy=last_pitch+gy*dt$

定义k代表加速度计的权重,1-k即陀螺仪的权重,最终得到$pitch=k\times angleAy+(1-k)\times angleGy$

## 四元数

## 卡尔曼滤波

## 数字运动处理器DMP

# 主控

![](https://img-blog.csdnimg.cn/img_convert/1fef0322b05f30dbbbf85fc3b75e3abd.png)

![请添加图片描述](https://img-blog.csdnimg.cn/dba50aeb72464b13afd633c122a149b2.gif)
目前已实现的功能有获取俯仰角与横滚角,角度超过60°时led亮,选用集成到一片pcb可以进一步缩小体积,降低成本.

# 跌倒检测

跌倒判断就是要区分跌倒行为和日常活动,标记异常活动并报警;对老年人,跌倒会导致比较严重的后果,检测原则是允许出现误报,但不允许出现漏报,所以需要一组合适的阈值进行判断;其次是可穿戴设备要适应老年人的生活习惯,尽量简化装备和操作流程.

- 跌倒原因
  - 行为因素:药物,醉酒,疲劳
  - 生理因素:骨质酥松,肌肉无力,昏厥,低血糖,高血压
  - 物理环境:地滑,照明,障碍物,楼梯,台阶,路面不平,雨雪,交通工具
- 跌倒种类
  - 向前扑倒,向后跌倒,向侧方跌倒

几种跌倒情况的共同特征是躯干的俯仰角或横滚角在短时间内剧烈变化,同样由于失重和与地面撞击,加速度也会剧烈变化,日常生活中,为了排除各项日常活动带来的干扰,需要将角速度和加速度综合考虑.

所以,出于便携性,实用性和准确性考虑,姿态传感器最佳安放位置为腰部,可以设计为腰带形式,在穿戴状态下启动.在躺下入睡或坐下时可以选择解除腰带.

## 跌倒分析
跌倒过程一般分为四个阶段:
- 直立静止或行走状态:人体z轴加速度为一倍重力加速度,pr角和加速度有轻微变化
- 跌倒阶段:人体位于失重状态,z轴加速度变小
- 撞击阶段:撞击到地面瞬间,加速度值方向改变到达一个峰值后回落,方向再次改变到达另一个峰值,并再次回落
- 静止阶段:可能躺倒在地面或者仰坐,侧坐

## 量化分析
- 加速度幅度值$SVM=\sqrt{a_x^2+a_y^2+a_z^2}$
- z轴倾角$\omega=\sqrt{\omega_p^2+\omega_r^2}$
- 离散程度$V=\frac{\frac{1}{n}\sum_{i=1}^nX_i}{\sqrt{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2}}$

一般情况下跌倒会在1~2秒内发生,所以在数秒以内,SVM值会出现数个明显峰值,$\omega$也会有较大变化,同时这两个值得离散程度也会有较大变化,对这三个值设定阈值,可以比较准确地对跌倒进行监测.

## 干扰分析
- 考虑到跌倒后可能存在坐起的情况,z轴倾角的权重可以设置小一些,而把反映倾角变化的离散程度的权重设置得大一些.
- 对于午睡或躺在座椅上的情景,z轴倾角的变化情况也与跌倒有一定重合,但通常在睡眠场合,腰带等会被摘下,所以可以暂时忽略
- 突然坐下时,SVM数值变化也与跌倒相似,都有失重,撞击,反弹,静止的过程,但这种场合下z轴变化不明显

# 方案比较
视觉方案
- 优点
  - 老人一般记性较差,视觉方案不需要老人进行操作
  - 可以同时检测一个场景内多个老人
- 缺点
  - 部署成本高,每一个房间都需要一个以上摄像头
  - 对于室内场景,家具,房间等较多,很容易出现遮挡情况
  - 存在隐私问题
  - 计算量大,要考虑供电和视频信号处理,耗电量也大
姿态传感器方案
- 优点
  - 不受时空局限,在室内室外均可检测
  - 计算量小,成本低
- 缺点
  - 需要培养穿戴习惯
  - 要注意电池更换